<span style="display: none;" id='markerData'> <%= @markerData %></span>

<header class="trip-name">
  <h1>Trip Name: <%= @trip.name %></h1>
</header>

<nav class="clear-fix trip-nav">
  <a class = "btn btn-info btn-map show_hide_trip-box"> + Trip</a>
  <a class = "btn btn-primary btn-map show_hide_place-box"> + Place</a>
</nav>

<aside>
  <%= render :template => "trips/new" %>
  <%= render :template => "places/new" %>
</aside>

<!--nav class="floating-nav">
  <header>
    <h4>Add more</h4>
  </header>
  <%= link_to "+ Trip", new_trip_path(@trip), :class => "btn btn-info btn-map" %>
  <%= link_to "+ Place", new_trip_place_path(@trip), :class => "btn btn-primary btn-map" %>
</nav-->

<script type="text/javascript">
  $(document).ready(function(){
        $(".place-box").hide();
        $(".show_hide_place-box").show();
        $('.show_hide_place-box').click(function(){
          $(".place-box").slideToggle();
        });
      });
  $(document).ready(function(){
        $(".trip-box").hide();
        $(".show_hide_trip-box").show();
        $('.show_hide_trip-box').click(function(){
          $(".trip-box").slideToggle();
        });
      });
</script>


<script type='text/javascript'>

  var markerData = $.parseJSON($("#markerData").text())

  window.markersOnMap = [];

  function initialize() {

    for (var i = markerData.length - 1; i >= 0; i--) {
      var place = markerData[i];
      var placeLatLong = new google.maps.LatLng(place.latitude, place.longitude);
      };

    var mapOptions = {
      center: new google.maps.LatLng(place.latitude, place.longitude ),
      zoom: 10,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    window.map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);

    for (var i = markerData.length - 1; i >= 0; i--) {
      var place = markerData[i];
      var placeLatLong = new google.maps.LatLng(place.latitude, place.longitude);
      var marker = new google.maps.Marker({
        position: placeLatLong,
        map: window.map,
        title: place.name
      });

      var infowindow = new google.maps.InfoWindow({
        content: place.name
      });
      markersOnMap.push(place.name);
    };

    var LatLngList = new Array
    //  Create a new viewpoint bound
    for (var i = markerData.length - 1; i >= 0; i--) {
      var place = markerData[i];
      LatLngList.push(new google.maps.LatLng(place.latitude,place.longitude));
    }
    //  Create a new viewpoint bound
    var bounds = new google.maps.LatLngBounds ();
    //  Go through each...
    for (var i = 0, LtLgLen = LatLngList.length; i < LtLgLen; i++) {
    //  And increase the bounds to take this point
      bounds.extend (LatLngList[i]);
    }
    //  Fit these bounds to the map
    map.fitBounds (bounds);
  };
  google.maps.event.addDomListener(window, 'load', initialize);
</script>



<div id="map-canvas" style="width: 100%; height: 100%">
</div>
